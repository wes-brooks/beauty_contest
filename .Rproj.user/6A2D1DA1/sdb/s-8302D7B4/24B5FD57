{
    "contents" : "trimplot = function(plotdata) {\n    d = data.frame()\n    for (row in rownames(plotdata)) {\n        d = rbind(d, cbind(as.vector(as.numeric(plotdata[row,])), as.numeric(rep(row, ncol(plotdata))), as.numeric(colnames(plotdata))))\n    }\n    colnames(d) = c('emission', 'ex_freq', 'em_freq')\n    d = d[apply(d, 1, function(x) !any(is.na(x))),]\n    \n    \n    for(f in unique(d$ex_freq)) {\n        first_em = min(d$em_freq[d$ex_freq==f], na.rm=TRUE)\n        d$em_freq[d$ex_freq==f] = d$em_freq[d$ex_freq==f] - (first_em - 290)\n    }\n    \n    #Trim some data at high emission wavelengths and high excitation wavelengths\n    for(f in unique(d$ex_freq)) {\n        last_em = max(d$em_freq[d$ex_freq==f], na.rm=TRUE)\n        d$emission[d$ex_freq==f & d$em_freq>468] = NA\n        if (last_em < 468) {\n            d$emission[d$ex_freq==f] = NA\n        }\n    }\n    \n    d = d[apply(d, 1, function(x) !any(is.na(x))),]\n    #midpoint=quantile(d$emission, 0.90)\n    #midpoint=0\n    \n    ggplot(d) + aes(x=ex_freq, y=em_freq, color=emission) +\n        scale_color_gradientn(limits=c(-1.28,21.1), colours=c('purple', 'yellow', 'red')) +\n        geom_point(aes(shape=15, size=14)) +\n        scale_x_continuous(expand=c(0,0)) + \n        scale_y_continuous(expand=c(0,0)) +\n        scale_shape_identity() +\n        scale_size_identity() +\n        theme(axis.line=element_blank(),axis.text.x=element_blank(),\n               axis.text.y=element_blank(),axis.ticks=element_blank(),\n               axis.title.x=element_blank(),\n               axis.title.y=element_blank(),legend.position=\"none\",\n               panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),\n               panel.grid.minor=element_blank(),plot.background=element_blank())\n}",
    "created" : 1393889357294.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4068282689",
    "id" : "24B5FD57",
    "lastKnownWriteTime" : 1393894541,
    "path" : "~/eem/trimmed-plot.r",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}